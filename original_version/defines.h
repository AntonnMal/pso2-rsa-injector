// Constant variables:
#define KEYSIZE 0x80
#define RSASIZE 0xA0
#define KEYAMNT 4

unsigned char jumpfromimport[] = {
	0xE9, 0x00, 0x00, 0x00, 0x00, 	//jmp [offset]
	};
unsigned char jumptodetour[] = {
	0x48, 0x81, 0xEC, 0x00, 0x05, 0x00, 0x00,					// sub rsp, 0x500
	0x50,														// push rax
	0x53,														// push rbx
	0x51,														// push rcx
	0x52,														// push rdx
	0x55,														// push rbp
	0x56,														// push rsi
	0x57,														// push rdi
	0x41, 0x50,													// push r8
	0x41, 0x51,													// push r9
	0x41, 0x52,													// push r10
	0x41, 0x53,													// push r11
	0x41, 0x54,													// push r12
	0x41, 0x55,													// push r13
	0x41, 0x56,													// push r14
	0x41, 0x57,													// push r15
	0x3E, 0x48, 0x8B, 0x94, 0x24, 0xA8, 0x05, 0x00, 0x00,		// mov rdx, qword ptr ds:[rsp+0x5A8]
	0x3E, 0x48, 0x8B, 0x8C, 0x24, 0xA0, 0x05, 0x00, 0x00,		// mov rcx, qword ptr ds:[rsp+0x5A0]
	0x48, 0xB8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,	// mov rax, [offset]
	0xFF, 0xD0,													// call rax
	0x41, 0x5F,													// pop r15
	0x41, 0x5E,													// pop r14
	0x41, 0x5D,													// pop r13
	0x41, 0x5C,													// pop r12
	0x41, 0x5B,													// pop r11
	0x41, 0x5A,													// pop r10
	0x41, 0x59,													// pop r9
	0x41, 0x58,													// pop r8
	0x5F,														// pop rdi
	0x5E,														// pop rsi
	0x5D,														// pop rbp
	0x5A,														// pop rdx
	0x59,														// pop rcx
	0x5B,														// pop rbx
	0x58,														// pop rax
	0x48, 0x81, 0xC4, 0x00, 0x05, 0x00, 0x00,					// add rsp, 0x500
	0x00, 0x00, 0x00, 0x00, 0x00,
	0xE9, 0x00, 0x00, 0x00, 0x00								// jmp [offset]
	};
unsigned char RSAHeader[] = {
	0x06, 0x02, 0x00, 0x00, 0x00, 0xA4, 0x00, 0x00, 0x52, 0x53, 0x41, 0x31, 0x00, 0x04, 0x00, 0x00
};

// Text to Inject failed to open publickey.blob
LPCTSTR fopenText = "Failed to open publickey.blob";
LPCTSTR LoadLibraryAText = "Failed to load detour.dll";
// Caption to Inject failed to open publickey.blob
LPCTSTR fopenCaptionText = "fopen() failed";
LPCTSTR LoadLibraryACaptionText = "LoadLibraryA() failed";
const UINT InjectBoxFlags = MB_OK|MB_ICONERROR;